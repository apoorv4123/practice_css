<!DOCTYPE html>
<html lang="en">
<head>
    <!-- <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>FilmyGossip</title> -->
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="style-src 'self'" >
    <link rel="stylesheet" href="style.css">
    <title>FilmyGossip</title>
</head>
<body>
    <h1 id="heading"> Welcome to FilmyGossip </h1>
    <br>
    <div id="container">
        <h2 id="title">
            <u>Movie Rating</u>
        </h2><br>
        <h3 id="movieDetails"></h3>
        <h3>Rating: 5/5</h3>
    </div>
    <hr>
    <footer>
        <p>FilmyGossip
            <span> &copy; 2019</span>
        </p>
        <p>
            <u>Contact Us:</u>
        </p>
        <p>Mail Id: filmyupdates@gossip.com</p>
        <p id="footer">** Disclaimer: This demo is only for Educational purpose. Please do not try this attack on any commercial website **
    </footer>
    <script>
        var position = document.URL.indexOf("movie=") + 6;
        var name = "Movie Name: " + decodeURIComponent(document.URL.substring(position)).replace(/\+/g,' ');
        document.getElementById("movieDetails").innerHTML = name;
    </script>
</body>
</html>
<!-- In lines 31-35, the data is retrieved from the URL and inserted into the element containing 'movieDetails' Id. -->
<!-- Step 1: css-seq.html
Step 2: detils.html
Step 3: Open the css-seq.html page in a browser and inject CSS in the search bar. Change in the text color of the heading can be observed.

Let us now mitigate this scenario by setting the CSP header in the meta tag.
Step 4: Below is a code snippet of the details.html page under the mitigation folder.
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="style-src 'self'" >
    <link rel="stylesheet" href="style.css">
    <title>FilmyGossip</title>
</head>
In line3,  Content-Security-Policy is added in the 'http-equiv' attribute in the meta tag, 'self' refers to the origin from which the document is being served. -->